<html>
    <head>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
    <body>
        <input type="text" id="command"/><input type="button" id="button" value="OK"/><br/>
        <canvas id="myChart" width="400" height="200"></canvas>
        <script>
            function click(){
                const cmd = document.getElementById('command').value;
                const words = cmd.split(' ');

                var url = document.URL.substring(0, document.URL.indexOf("/static")) + "/json";
                var inOptions = false;
                words.forEach(word => {
                    if (word[0] == '-') {
                        if (inOptions == false) {
                            inOptions = true;
                            url += '?' + word.substring(1);
                        } else {
                            url += '&' + word.substring(1);
                        }
                    } else {
                        if (inOptions) {
                            url += '+' + word
                        } else {
                            url += '/' + word
                        }
                        
                    }
                });

                console.log(url);
                const xhttp = new XMLHttpRequest();
                xhttp.responseType = 'json';
                xhttp.onload = function() {
                    if (window.chart != null) {
                        window.chart.destroy();
                    }

                    const ctx = document.getElementById('myChart').getContext('2d');
                    window.chart = new Chart(ctx, this.response);
                }
                xhttp.open("GET", url);
                xhttp.send();
            }

            const button = document.getElementById('button');
            button.onclick = click;
        </script>
    </body>
</html>
